{% extends "base.html" %}
{% load static %}
{% load static %}
{% load color_tags %} {# åŠ è½½è‡ªå®šä¹‰é¢œè‰²æ ‡ç­¾ #}
{% block extra_css %}

    <!-- å¼•å…¥ä¸»é¡µä¸“ç”¨CSS -->
    <link rel="stylesheet" href="{% static 'css/home.css' %}">
    <link rel="stylesheet" href="{% static 'css/profile.css' %}">
<!-- åœ¨headæ ‡ç­¾ä¸­å¼•å…¥é«˜å¾·åœ°å›¾API -->
<script src="https://webapi.amap.com/maps?v=2.0&key=512ef80e3828defb1ddc0d62e6fc0dfd&plugin=AMap.Geocoder,AMap.Geolocation"></script>
<!-- <script src="https://webapi.amap.com/maps?v=2.0&key=512ef80e3828defb1ddc0d62e6fc0dfd"></script> -->
{% endblock %}

{% block content %}
<div class="main-content-column">
        <!-- æ–‡ç« è½®æ’­åŠŸèƒ½ -->
        <div class="article-carousel-section">
            <h3 class="section-title">
                <i class="fas fa-book"></i> ç²¾é€‰æ–‡ç« 
            </h3>
            <div class="carousel-container">
                <div class="carousel-slider">
                    {% for article in articles %}
                    <div class="carousel-item">
                        <!-- å›¾ç‰‡åŒºåŸŸ -->
                        <div class="image-content">
                            {% if article.image and article.image.url %}
                            <img src="{{ article.image.url }}" alt="{{ article.title }}" class="article-image">
                            {% else %}
                            <img src="{% static 'img/default-cover.jpg' %}" alt="é»˜è®¤å°é¢" class="article-image">
                            {% endif %}
                        </div>
                        
                        <!-- æ–‡å­—å†…å®¹åŒºåŸŸ -->
                        <div class="text-content">
                            <h4 class="article-title">{{ article.title }}</h4>
                            <div class="article-excerpt-container">
                                <p class="article-excerpt">{{ article.summary|truncatechars:80 }}</p>
                            </div>
                            <div class="btn-container">
                                <a href="{{ article.get_absolute_url }}" class="btn btn-primary">é˜…è¯»å…¨æ–‡</a>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
                <div class="carousel-nav">
                    {% for i in articles %}
                    <span class="carousel-dot" data-index="{{ forloop.counter0 }}"></span>
                    {% endfor %}
                </div>
            </div>
        </div>
        <!-- é€æ˜å›¾æ ‡+æ–‡å­—ç€‘å¸ƒæµ -->
        <div class="multi-stream-container">
            <h3 class="section-title">
                <i class="fas fa-book"></i> ä¼˜è´¨è¯„è®º
            </h3>
            <div class="transparent-icon-stream">
                <!-- ç¬¬ä¸€è¡Œè¯„è®ºè½¨é“ -->
                <div class="icon-track" id="track-row1"></div>
                
                <!-- ç¬¬äºŒè¡Œè¯„è®ºè½¨é“ -->
                <div class="icon-track" id="track-row2"></div>
                
                <!-- ç¬¬ä¸‰è¡Œè¯„è®ºè½¨é“ -->
                <div class="icon-track" id="track-row3"></div>
            </div>
        </div>
        <!-- ç¬¬ä¸‰éƒ¨åˆ†ï¼šä¸ªäººä»‹ç» -->
        <div class="profile-section">
            <!-- å·¦ä¾§æŠ€æœ¯å±•ç¤ºåŒº -->
            <div class="tech-area">
                <!-- å·¦ä¸‹è§’ä¸ªäººç®€ä»‹åŒº -->
                <div class="personal-info">
                    <p class="greeting">ä½ å¥½ï¼Œå¾ˆé«˜å…´è®¤è¯†ä½  ğŸ¤</p>
                    <h2 class="name">æˆ‘å«é™ˆé”™</h2>
                    <p class="roles">æ˜¯ä¸€å<span>äº‘è®¡ç®—è¿ç»´å¸ˆ</span>ã€<span>å­¦ç”Ÿ</span>ã€<span>äºŒæ¬¡å…ƒçˆ±å¥½è€…</span>ã€<span>éº»ç“œ</span></p>
                </div>
                <div class="creativity-title">
                    <h3>å¼€å¯åˆ›é€ åŠ›</h3>
                    <div class="underline"></div>
                </div>
                <div class="tech-grid">
                    <!-- ç¬¬ä¸€è¡Œ -->
                    <div class="tech-item">
                        <div class="tech-icon" style="background-color: #ff7043;">
                            <span>Python</span>
                        </div>
                    </div>
                    <div class="tech-item">
                        <div class="tech-icon" style="background-color: #0db7e4;">
                            <span>Docker</span>
                        </div>
                    </div>
                    <div class="tech-item">
                        <div class="tech-icon" style="background-color: #2196f3;">
                            <span>K8s</span>
                        </div>
                    </div>
                    <div class="tech-item">
                        <div class="tech-icon" style="background-color: #4caf50;">
                            <span>Mysql</span>
                        </div>
                    </div>
                    
                    <!-- ç¬¬äºŒè¡Œ -->
                    <div class="tech-item">
                        <div class="tech-icon" style="background-color: #9c27b0;">
                            <span>Django</span>
                        </div>
                    </div>
                    <div class="tech-item">
                        <div class="tech-icon" style="background-color: #e91e63;">
                            <span>jenkins</span>
                        </div>
                    </div>
                    <div class="tech-item">
                        <div class="tech-icon" style="background-color: #3f51b5;">
                            <span>Github</span>
                        </div>
                    </div>
                    <div class="tech-item">
                        <div class="tech-icon" style="background-color: #ff9800;">
                            <span>Linux</span>
                        </div>
                    </div>
                    <div class="tech-item">
                        <div class="tech-icon" style="background-color: #607d8b;">
                            <span>Zabbix</span>
                        </div>
                    </div>
                    
                    <!-- ç¬¬ä¸‰è¡Œ -->
                    <div class="tech-item">
                        <div class="tech-icon" style="background-color: #00bcd4;">
                            <span>ansible</span>
                        </div>
                    </div>
                    <div class="tech-item">
                        <div class="tech-icon" style="background-color: #61dafb;">
                            <span>Html5</span>
                        </div>
                    </div>
                    <div class="tech-item">
                        <div class="tech-icon" style="background-color: #2965f1;">
                            <span>CSS3</span>
                        </div>
                    </div>
                    <div class="tech-item">
                        <div class="tech-icon" style="background-color: #f7df1e;">
                            <span>Hadoop</span>
                        </div>
                    </div>
                    <div class="tech-item">
                        <div class="tech-icon" style="background-color: #e44d26;">
                            <span>Openstack</span>
                        </div>
                    </div>
                    
                    <!-- ç¬¬å››è¡Œ -->
                    <div class="tech-item">
                        <div class="tech-icon" style="background-color: #f05133;">
                            <span>Git</span>
                        </div>
                    </div>
                    <div class="tech-item">
                        <div class="tech-icon" style="background-color: #41b883;">
                            <span>Redhat</span>
                        </div>
                    </div>
                    <div class="tech-item">
                        <div class="tech-icon" style="background-color: #4caf50;">
                            <span>...</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- å³ä¾§åœ°å›¾åŒºåŸŸ -->
            <div class="right-column">
                <!-- åœ°å›¾åŒºåŸŸ (é«˜åº¦ç¼©çŸ­ä¸º250px) -->
                <div class="location-area">
                    <div id="map-container">
                        <div id="amap-container" style="width:100%; height:100%;"></div>
                        <div class="location-label">
                            <i class="fas fa-map-marker-alt"></i>
                            <span id="location-text">æ¹–åŒ—æ­¦æ±‰</span>
                        </div>
                    </div>
                </div>
                <!-- æ—¶é’Ÿ -->
                <div class="clock-container">
                    <div class="clock-widget">
                        <div class="time-display" id="current-time">00:00:00</div>
                        <div class="date-display" id="current-date">2023å¹´1æœˆ1æ—¥</div>
                    </div>
                </div>
                
                <!-- æ–°å¢æ ‡ç­¾è½®æ’­åŒºåŸŸ -->
                <div class="tags-carousel">
                    <!-- ç¬¬ä¸€ç»„æ ‡ç­¾ -->
                    <div class="tag-group active">
                        <div class="tag-item">åŠ¨æ¼«çˆ±å¥½è€…</div>
                        <div class="tag-item">åˆ†äº«ä¸çƒ­å¿ƒ</div>
                        <div class="tag-item">äº‘è®¡ç®—å°ç‰›</div>
                        <div class="tag-item">è´ªç©è€Œå¥½åƒ</div>
                    </div>
                    
                    <!-- ç¬¬äºŒç»„æ ‡ç­¾ -->
                    <div class="tag-group">
                        <div class="tag-item">ç§¯æä¹å¤©æ´¾</div>
                        <div class="tag-item">å®åœ°è¡ŒåŠ¨æ´¾</div>
                        <div class="tag-item">å›¢é˜Ÿå‘åŠ¨æœº</div>
                        <div class="tag-item">ç‹ äººè¯ä¸å¤š</div>
                    </div>
                </div>
                <!-- ç‰¹é•¿ -->
                <div class="specialty-card-container">
                    <div class="specialty-card">
                        <!-- ä¸»æ ‡é¢˜ä¸è£…é¥° -->
                        <div class="card-header-techang">
                            <div class="card-title">ç‰¹é•¿</div>
                            <div class="decoration">
                                <div class="triangle"></div>
                                <div class="triangle"></div>
                            </div>
                        </div>
                        
                        <!-- å¡ç‰‡å†…å®¹ -->
                        <div class="card-content">
                            <div class="main-text">è„‘å›è·¯æ–°å¥‡çš„äººå¤</div>
                            <div class="secondary-text">äºŒæ¬¡å…ƒæŒ‡æ•° MAX</div>
                        </div>
                        
                        <!-- æ˜Ÿå…‰è£…é¥° -->
                        <div class="stardust"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}

<script>
document.addEventListener('DOMContentLoaded', function() {
    // 1. ä»Djangoè§†å›¾è·å–è¯„è®ºæ•°æ®
    const serverComments = JSON.parse('{{ comments_data|escapejs }}');
    
    // ç¡®ä¿æœ‰è¯„è®ºæ•°æ®
    if (!serverComments || serverComments.length === 0) {
        serverComments = [
            {"author": "ç³»ç»Ÿ", "content": "æš‚æ— è¯„è®ºï¼Œæ¬¢è¿ç¬¬ä¸€æ¡ç•™è¨€ï¼"},
            {"author": "å®˜æ–¹", "content": "ç²¾å½©å†…å®¹å³å°†æ›´æ–°"},
            {"author": "æç¤º", "content": "ç‚¹å‡»æ­¤å¤„å‘è¡¨æ‚¨çš„è§‚ç‚¹"}
        ];
    }
    
    // åˆå§‹åŒ–ç€‘å¸ƒæµ
    initCommentStream(serverComments);
    
    // 2. è½®æ’­åŠŸèƒ½ï¼ˆä¿æŒåŸæœ‰åŠŸèƒ½ï¼‰
    initCarousel();
});

// åˆå§‹åŒ–ç€‘å¸ƒæµ
function initCommentStream(comments) {
    // ç¡®ä¿æœ‰è¶³å¤Ÿçš„æ•°æ®ï¼ˆè‡³å°‘3æ¡ï¼‰
    if (comments.length < 3) {
        const baseComments = [
            {author: "ç”¨æˆ·", content: "è¿™æ˜¯ä¸€æ¡ç¤ºä¾‹è¯„è®º"},
            {author: "è®¿å®¢", content: "ç½‘ç«™å†…å®¹å¾ˆæœ‰å¸®åŠ©"},
            {author: "è¯»è€…", content: "æœŸå¾…æ›´å¤šæ›´æ–°"}
        ];
        comments = [...comments, ...baseComments.slice(0, 3 - comments.length)];
    }
    
    // å¡«å……ä¸‰è¡Œè½¨é“
    fillCommentTrack('track-row1', comments);
    fillCommentTrack('track-row2', comments);
    fillCommentTrack('track-row3', comments);
}

// å¡«å……å•ä¸ªè½¨é“
function fillCommentTrack(trackId, comments) {
    const track = document.getElementById(trackId);
    if (!track) return;
    
    // æ¸…ç©ºè½¨é“
    track.innerHTML = '';
    
    // åˆ›å»ºé¢œè‰²æ•°ç»„
    const colors = ['#FF7043', '#3498DB', '#9B59B6', '#2ECC71', '#F1C40F', '#E74C3C'];
    
    // æ·»åŠ è¯„è®ºé¡¹
    comments.forEach((comment, index) => {
        const combo = document.createElement('div');
        combo.className = 'icon-combo';
        
        // è·å–ä½œè€…é¦–å­—æ¯
        const initial = comment.author && comment.author.length > 0 ? 
            comment.author.charAt(0).toUpperCase() : '?';
        
        // éšæœºé€‰æ‹©é¢œè‰²
        const colorIndex = Math.floor(Math.random() * colors.length);
        
        combo.innerHTML = `
            <div class="minimal-icon" style="background-color: ${colors[colorIndex]};">
                <span>${initial}</span>
            </div>
            <div class="text-bubble">${comment.content}</div>
        `;
        
        track.appendChild(combo);
    });
    
    // æ·»åŠ å‰¯æœ¬ç¡®ä¿è¿ç»­æ€§
    comments.slice(0, Math.max(1, Math.floor(comments.length/2))).forEach(comment => {
        const combo = document.createElement('div');
        combo.className = 'icon-combo';
        
        const initial = comment.author && comment.author.length > 0 ? 
            comment.author.charAt(0).toUpperCase() : '?';
        
        const colorIndex = Math.floor(Math.random() * colors.length);
        
        combo.innerHTML = `
            <div class="minimal-icon" style="background-color: ${colors[colorIndex]};">
                <span>${initial}</span>
            </div>
            <div class="text-bubble">${comment.content}</div>
        `;
        
        track.appendChild(combo);
    });
}

// è½®æ’­åŠŸèƒ½
function initCarousel() {
    const slider = document.querySelector('.carousel-slider');
    const dots = document.querySelectorAll('.carousel-dot');
    const items = document.querySelectorAll('.carousel-item');
    
    if (!slider || !items.length) return;
    
    let currentIndex = 0;
    
    function updateSlider() {
        slider.style.transform = `translateX(-${currentIndex * 100}%)`;
        
        // æ›´æ–°æŒ‡ç¤ºç‚¹çŠ¶æ€
        dots.forEach((dot, index) => {
            dot.classList.toggle('active', index === currentIndex);
        });
    }
    
    // ç‚¹å‡»æŒ‡ç¤ºç‚¹åˆ‡æ¢
    dots.forEach(dot => {
        dot.addEventListener('click', () => {
            currentIndex = parseInt(dot.dataset.index);
            updateSlider();
        });
    });
    
    // è‡ªåŠ¨è½®æ’­
    setInterval(() => {
        currentIndex = (currentIndex + 1) % items.length;
        updateSlider();
    }, 5000);
}
</script>
<script>
$(document).ready(function() {   
    // 2. æ–‡ç« è½®æ’­åŠŸèƒ½
    const slider = $('.carousel-slider');
    const items = $('.carousel-item');
    const dots = $('.carousel-dot');
    let currentIndex = 0;
    let slideInterval;
    
    // æ˜¾ç¤ºæŒ‡å®šå¹»ç¯ç‰‡
    function showSlide(index) {
        slider.css('transform', `translateX(-${index * 100}%)`);
        dots.removeClass('active').eq(index).addClass('active');
        currentIndex = index;
    }
    
    // è‡ªåŠ¨è½®æ’­
    function startAutoSlide() {
        slideInterval = setInterval(function() {
            currentIndex = (currentIndex + 1) % items.length;
            showSlide(currentIndex);
        }, 5000);
    }
    
    // ç‚¹é€‰åˆ‡æ¢å¹»ç¯ç‰‡
    dots.click(function() {
        clearInterval(slideInterval);
        const index = $(this).data('index');
        showSlide(index);
        startAutoSlide();
    });
    
    // åˆå§‹åŒ–è½®æ’­
    showSlide(0);
    startAutoSlide();
});  // ä¿®å¤åçš„é—­åˆï¼Œåªæœ‰ä¸€ä¸ªå¤§æ‹¬å·å’Œå°æ‹¬å·
</script>
<script>
document.addEventListener('DOMContentLoaded', function() {
    // åˆ›å»ºæ˜Ÿç©ºèƒŒæ™¯
    function createStarryBackground() {
        const profileSection = document.querySelector('.profile-section');
        const stars = 200;
        
        for (let i = 0; i < stars; i++) {
            const star = document.createElement('div');
            star.classList.add('star');
            
            // éšæœºä½ç½®
            const posX = Math.random() * 100;
            const posY = Math.random() * 100;
            star.style.left = `${posX}%`;
            star.style.top = `${posY}%`;
            
            // éšæœºå¤§å°
            const size = Math.random() * 3;
            star.style.width = `${size}px`;
            star.style.height = `${size}px`;
            
            // éšæœºé€æ˜åº¦
            const opacity = Math.random() * 0.7 + 0.1;
            star.style.opacity = opacity;
            
            // éšæœºåŠ¨ç”»æŒç»­æ—¶é—´
            const duration = Math.random() * 4 + 2;
            star.style.animationDuration = `${duration}s`;
            
            profileSection.appendChild(star);
        }
    }
    
    // åˆå§‹åŒ–æ˜Ÿç©ºèƒŒæ™¯
    createStarryBackground();
    
});

// ä¸ªäººç®€ä»‹äº¤äº’æ•ˆæœ
document.addEventListener('DOMContentLoaded', function() {
    const personalInfo = document.querySelector('.personal-info');
    
    // åˆ›å»ºè£…é¥°æ°”æ³¡
    function createBubbles() {
        // æ¸…é™¤ç°æœ‰æ°”æ³¡
        personalInfo.querySelectorAll('.bubble').forEach(b => b.remove());
        
        // åˆ›å»ºæ°”æ³¡
        for (let i = 0; i < 6; i++) {
            const bubble = document.createElement('div');
            bubble.classList.add('bubble');
            bubble.style.width = `${Math.random() * 80 + 20}px`;
            bubble.style.height = bubble.style.width;
            
            // éšæœºä½ç½®
            bubble.style.left = `${Math.random() * 100}%`;
            bubble.style.top = `${Math.random() * 100}%`;
            
            // éšæœºèƒŒæ™¯è‰²
            const colors = ['rgba(255, 255, 255, 0.12)', 'rgba(255, 255, 255, 0.08)', 'rgba(255, 255, 255, 0.15)'];
            bubble.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
            
            personalInfo.appendChild(bubble);
        }
    }
    
    if (personalInfo) {
        // åˆå§‹æ°”æ³¡
        createBubbles();
        
        // ç‚¹å‡»æ•ˆæœ
        personalInfo.addEventListener('click', function(e) {
            // æ³¢çº¹æ•ˆæœ
            createRipple(e);
            
            // å¼¹å‡ºåŠ¨ç”»
            this.style.transform = 'scale(0.95)';
            this.style.boxShadow = '0 5px 15px rgba(0, 0, 0, 0.1)';
            
            // æ–‡å­—åŠ¨ç”»
            this.querySelector('.greeting').style.transform = 'translateX(5px)';
            this.querySelector('.name').style.transform = 'scale(1.05)';
            this.querySelector('.name').style.letterSpacing = '1.5px';
            
            setTimeout(() => {
                this.style.transform = 'scale(1)';
                this.style.boxShadow = '0 8px 25px rgba(0, 0, 0, 0.15)';
                this.querySelector('.greeting').style.transform = 'translateX(0)';
                this.querySelector('.name').style.transform = 'scale(1)';
                this.querySelector('.name').style.letterSpacing = '0';
                
                // æ›´æ–°æ°”æ³¡ä½ç½®
                createBubbles();
            }, 300);
        });
        
        // é¼ æ ‡æ‚¬åœæ•ˆæœ
        personalInfo.addEventListener('mouseenter', function() {
            this.style.transform = 'translateY(-5px)';
            this.style.boxShadow = '0 15px 30px rgba(0, 0, 0, 0.2)';
        });
        
        personalInfo.addEventListener('mouseleave', function() {
            this.style.transform = 'translateY(0)';
            this.style.boxShadow = '0 8px 25px rgba(0, 0, 0, 0.15)';
        });
    }
    
    // åˆ›å»ºç‚¹å‡»æ³¢çº¹æ•ˆæœ
    function createRipple(e) {
        const rect = personalInfo.getBoundingClientRect();
        const x = e.clientX - rect.left;
        const y = e.clientY - rect.top;
        
        const ripple = document.createElement('span');
        ripple.classList.add('ripple');
        ripple.style.left = `${x}px`;
        ripple.style.top = `${y}px`;
        
        personalInfo.appendChild(ripple);
        
        setTimeout(() => {
            ripple.remove();
        }, 600);
    }
});
</script>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // æ ‡ç­¾è½®æ’­åŠŸèƒ½
    const tagGroups = document.querySelectorAll('.tag-group');
    let currentIndex = 0;
    
    function startTagCarousel() {
        setInterval(() => {
            // ç§»é™¤å½“å‰æ´»è·ƒç»„çš„activeç±»
            tagGroups.forEach(group => group.classList.remove('active'));
            
            // è®¡ç®—ä¸‹ä¸€ä¸ªç´¢å¼•
            currentIndex = (currentIndex + 1) % tagGroups.length;
            
            // æ·»åŠ activeç±»åˆ°ä¸‹ä¸€ç»„
            tagGroups[currentIndex].classList.add('active');
        }, 2000); // 2ç§’åˆ‡æ¢ä¸€æ¬¡
    }
    
    // å¯åŠ¨æ ‡ç­¾è½®æ’­
    startTagCarousel();
});
// é«˜å¾·åœ°å›¾
document.addEventListener('DOMContentLoaded', function() {
    // ç¡®ä¿é«˜å¾·åœ°å›¾APIå·²åŠ è½½
    if (typeof AMap === 'undefined') {
        console.error('é«˜å¾·åœ°å›¾APIæœªåŠ è½½');
        return;
    }

    const defaultPosition = [114.428586, 30.449323];
    
    try {
        // åˆ›å»ºåœ°å›¾
        const map = new AMap.Map('amap-container', {
            zoom: 13,
            center: defaultPosition,
            viewMode: '3D',
            mapStyle: 'amap://styles/whitesmoke'
        });

        // æ·»åŠ æ ‡è®°
        const marker = new AMap.Marker({
            position: defaultPosition,
            map: map
        });

        // ä½¿ç”¨æ’ä»¶ç³»ç»Ÿ - ä¿®æ­£åçš„æ–¹æ³•
        AMap.plugin(['AMap.Geolocation', 'AMap.Geocoder', 'AMap.ToolBar', 'AMap.Scale'], function() {
            // åˆ›å»ºåœ°ç†ç¼–ç å™¨
            const geocoder = new AMap.Geocoder();
            
            // åˆ›å»ºåœ°ç†ä½ç½®å¯¹è±¡
            const geolocation = new AMap.Geolocation({
                enableHighAccuracy: true,
                timeout: 10000,
                buttonPosition: 'RB',
                buttonOffset: new AMap.Pixel(10, 10)
            });
            
            // æ·»åŠ æ§ä»¶åˆ°åœ°å›¾
            map.addControl(geolocation);
            
            // å®‰å…¨çš„äº‹ä»¶ç›‘å¬
            if (geolocation && typeof geolocation.on === 'function') {
                // å®šä½æˆåŠŸäº‹ä»¶
                geolocation.on('complete', function(data) {
                    console.log("å®šä½æˆåŠŸ:", data);
                    if (data.position) {
                        const position = [data.position.lng, data.position.lat];
                        marker.setPosition(position);
                        map.setCenter(position);
                        
                        // æ›´æ–°ä½ç½®æ–‡å­—
                        updateLocationText(geocoder, position);
                    }
                });
                
                // å®šä½å¤±è´¥äº‹ä»¶
                geolocation.on('error', function(data) {
                    console.log("å®šä½å¤±è´¥:", data);
                    updateLocationText(geocoder, defaultPosition, "æ¹–åŒ—çœæ­¦æ±‰å¸‚");
                });
            } else {
                console.warn("geolocationå¯¹è±¡æœªæ­£ç¡®åˆå§‹åŒ–");
                updateLocationText(geocoder, defaultPosition, "æ¹–åŒ—çœæ­¦æ±‰å¸‚");
            }
            
            // å¼€å§‹å®šä½
            geolocation.getCurrentPosition();
        });
        
        // æ·»åŠ ç¼©æ”¾æ§ä»¶
        const toolBar = new AMap.ToolBar();
        const scale = new AMap.Scale();
        map.addControl(toolBar);
        map.addControl(scale);

    } catch (error) {
        console.error('åœ°å›¾åˆå§‹åŒ–å¤±è´¥:', error);
        // æ˜¾ç¤ºé»˜è®¤ä½ç½®
        document.getElementById('location-text').textContent = "æ¹–åŒ—çœæ­¦æ±‰å¸‚";
    }
});

// æ›´æ–°ä½ç½®æ–‡æœ¬çš„å‡½æ•°
function updateLocationText(geocoder, position, fallback = "æœªçŸ¥ä½ç½®") {
    geocoder.getAddress(position, function(status, result) {
        const locationText = document.getElementById('location-text');
        if (!locationText) return;
        
        if (status === 'complete' && result.regeocode) {
            locationText.textContent = result.regeocode.formattedAddress || 
                                     result.regeocode.addressComponent.city + 
                                     result.regeocode.addressComponent.district;
        } else {
            locationText.textContent = fallback;
        }
    });
}
</script>
    
<style>
    .custom-marker {
        font-size: 36px;
        color: #e74c3c;
        text-shadow: 0 0 15px rgba(231, 76, 60, 0.3);
        animation: markerPulse 1.5s infinite;
    }
    
    @keyframes markerPulse {
        0% { transform: translateY(0) scale(1); }
        50% { transform: translateY(-5px) scale(1.2); }
        100% { transform: translateY(0) scale(1); }
    }


</style>
<script>
    // åˆ›å»ºè£…é¥°æ˜Ÿæ˜Ÿ
    document.addEventListener('DOMContentLoaded', function() {
        const card = document.querySelector('.specialty-card');
        if (!card) return;
        
        for (let i = 0; i < 15; i++) {
            const star = document.createElement('div');
            star.classList.add('star');
            
            // éšæœºä½ç½®
            const posX = Math.random() * 100;
            const posY = Math.random() * 100;
            star.style.left = `${posX}%`;
            star.style.top = `${posY}%`;
            
            // éšæœºå¤§å°
            const size = Math.random() * 2 + 1;
            star.style.width = `${size}px`;
            star.style.height = `${size}px`;
            
            // éšæœºåŠ¨ç”»å»¶è¿Ÿ
            const delay = Math.random() * 3;
            star.style.animationDelay = `${delay}s`;
            
            card.appendChild(star);
        }
    });
</script>
<script>
    // æ·»åŠ æ—¶é’ŸåŠŸèƒ½
    function updateClock() {
        const now = new Date();
        
        // æ ¼å¼åŒ–æ—¶é—´ HH:MM:SS
        const hours = String(now.getHours()).padStart(2, '0');
        const minutes = String(now.getMinutes()).padStart(2, '0');
        const seconds = String(now.getSeconds()).padStart(2, '0');
        
        // æ ¼å¼åŒ–æ—¥æœŸ YYYYå¹´MMæœˆDDæ—¥
        const year = now.getFullYear();
        const month = String(now.getMonth() + 1).padStart(2, '0');
        const day = String(now.getDate()).padStart(2, '0');
        
        // æ›´æ–°æ˜¾ç¤º
        document.getElementById('current-time').textContent = `${hours} ${minutes} ${seconds}`;
        document.getElementById('current-date').textContent = `${year}å¹´${month}æœˆ${day}æ—¥`;
    }
    
    // åˆå§‹åŒ–å¹¶æ¯ç§’æ›´æ–°æ—¶é’Ÿ
    document.addEventListener('DOMContentLoaded', function() {
        updateClock();
        setInterval(updateClock, 1000);
    });
</script>
{% endblock %}